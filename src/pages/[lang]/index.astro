---
import Layout from '@layouts/Base.astro';
import Burger from '@components/buttons/Burger.astro';
import MainLogo from '@images/logos/main-logo-horizontal.svg';
import Jokin from '@images/jokin.webp';
import LogoIsotipoWhite from '@images/logos/isotipo-white.svg';
import KeepScrolling from '@icons/keep-scrolling.svg';
import { nav } from '@config/nav';
import {
	getLangFromUrl,
	getStaticLangPaths,
	useTranslations
} from '@i18n/utils';
import DrawerNav from '@components/DrawerNav.astro';
import { Address, sectionImages, SERVICES } from '@config/company';
import Footer from '@components/core/Footer.astro';
import Container from '@components/core/Container.astro';
import LanguageToggle from '@components/LanguageToggle.astro';
import MarkerIcon from '@icons/marker.svg';
import { settings } from '@config/settings';
import { Image } from 'astro:assets';

export function getStaticPaths() {
	return getStaticLangPaths();
}

const url = Astro.url;
const lang = getLangFromUrl(url);
const t = useTranslations(lang);

// SEO data for the home page - optimized for Gipuzkoa/Guipúzcoa keywords
const seo = {
	title:
		lang === 'eu'
			? 'Laguntza Fisioterapia | Fisioterapia eta Osteopatia Gipuzkoan | Urnieta'
			: 'Laguntza Fisioterapia | Fisioterapia y Osteopatía en Gipuzkoa | Rehabilitación Urnieta',
	description: t(settings.description),
	keywords:
		lang === 'eu'
			? 'fisioterapia Gipuzkoa, fisioterapeuta Gipuzkoa, osteopatia Gipuzkoa, terapia manuala Gipuzkoa, errehabilitazioa Gipuzkoa, ariketa terapeutikoak Gipuzkoa, fisioterapia Urnieta, fisioterapia Donostia, puntzio lehorra Gipuzkoa, neuromodulazioa Gipuzkoa, fisioterapia zentroa Gipuzkoa, Zubitxo Plaza Urnieta'
			: 'fisioterapia Gipuzkoa, fisioterapia Guipúzcoa, fisioterapeuta Gipuzkoa, osteopatía Gipuzkoa, terapia manual Gipuzkoa, rehabilitación Gipuzkoa, rehabilitación ejercicio terapéutico Guipúzcoa, ejercicio terapéutico Gipuzkoa, fisioterapia Urnieta, fisioterapia Donostia, punción seca Gipuzkoa, neuromodulación Gipuzkoa, centro fisioterapia Guipúzcoa, Zubitxo Plaza Urnieta'
};
---

<Layout {seo}>
	<header
		slot="header"
		id="laguntzaFisioterapiaNavHeader"
		class="header-container"
	>
		<LanguageToggle />
		<div class="header-burger-container" id="header-burger-container">
			<Burger
				id="menuButton"
				aria-label={t('Menua ireki')}
				data-open-label={t('Menua ireki')}
				data-close-label={t('Menua itxi')}
				navData={nav}
				class="container-burger"
			/>
		</div>
	</header>
	<DrawerNav navData={nav} />
	<span id="global-loader" class="global-loader">
		<MainLogo id="main-logo-animated" />
	</span>
	<div class="landing-page" id="landing-page">
		<div id="logo-mask">
			<section>
				<picture id="hero-key" class="hero-key-picture">
					<MainLogo id="hero-key-logo" />
					<Image
						id="hero-key-background"
						src={Jokin}
						class="background-image"
						alt="Jokin Ramos González"
						layout="full-width"
						fetchpriority="high"
						loading="eager"
						width={2343}
						height={1562}
					/>
				</picture>
			</section>
		</div>

		<section class="landing-content">
			<div id="when">
				<h1 class="landing-h1">{t('home.h1')}</h1>
				<p class="landing-h1-sub">{t('home.h1.subtitle')}</p>
				<a
					class="coming-soon__address"
					href={Address.url}
					target="_blank"
					rel="noopener noreferrer"
				>
					<MarkerIcon fill="currentColor" />
					<span class="coming-soon__label">{Address.name}</span></a
				>
				<a
					href={`/${lang}/contact`}
					class="cta-button"
					aria-label={t('Hitzordua hartu') || 'Book Appointment'}
				>
					{t('Hitzordua hartu') || 'Book Appointment'}
				</a>
			</div>
		</section>

		{
			SERVICES[lang].sections.map((section, idx) => {
				const image = sectionImages[section.id as keyof typeof sectionImages];

				return (
					<section class="service-section">
						<div class="service-section__outer">
							<Container class="service-section-card">
								<Image
									src={image}
									alt={section.title}
									sizes="(max-width: 768px) 100vw, 50vw"
								/>

								<div class="service-section-card__bg-overlay" />
								<div class="service-section-card__desc">
									<h2>{section.title}</h2>
								</div>
							</Container>
						</div>
					</section>
				);
			})
		}
	</div>

	<div class="homepage-content" id="homepage-content">
		<section class="hc-intro" data-reveal>
			<Container narrow>
				<div class="hc-intro__inner">
					<div class="hc-intro__accent" aria-hidden="true"></div>
					<p class="hc-intro__text">{t('home.value-proposition')}</p>
				</div>
			</Container>
		</section>

		<section class="hc-about" data-reveal>
			<Container>
				<div class="hc-about__layout">
					<div class="hc-about__photo-col">
						<div class="hc-about__photo-frame">
							<Image
								src={Jokin}
								alt="Jokin Ramos González - Fisioterapeuta"
								class="hc-about__img"
								width={480}
								height={640}
							/>
						</div>
					</div>
					<div class="hc-about__text-col">
						<span class="hc-label"
							>{
								lang === 'eu'
									? 'Fisioterapeuta eta Osteopata'
									: 'Fisioterapeuta y Osteópata'
							}</span
						>
						<h2 class="hc-heading">{t('home.about-title')}</h2>
						<p class="hc-body">{t('home.about-text')}</p>
						<a href={`/${lang}/about`} class="hc-link">
							{t('home.about-cta')}
							<span class="hc-link__arrow">&rarr;</span>
						</a>
					</div>
				</div>
			</Container>
		</section>

		<section class="hc-services" data-reveal>
			<Container narrow>
				<div class="hc-services__rule" aria-hidden="true"></div>
				<div class="hc-services__split">
					<div class="hc-services__left">
						<h2 class="hc-heading hc-heading--gradient">
							{t('home.services-overview-title')}
						</h2>
					</div>
					<div class="hc-services__right">
						<p class="hc-body">{t('home.services-overview-text')}</p>
					</div>
				</div>
			</Container>
		</section>

		<section class="hc-specialties" data-reveal>
			<Container narrow>
				<h2 class="hc-heading">{t('home.specialties-title')}</h2>
				<div class="hc-tags">
					<span class="hc-tag">{t('home.specialty-1')}</span>
					<span class="hc-tag hc-tag--warm">{t('home.specialty-2')}</span>
					<span class="hc-tag">{t('home.specialty-3')}</span>
					<span class="hc-tag hc-tag--warm">{t('home.specialty-4')}</span>
					<span class="hc-tag">{t('home.specialty-5')}</span>
					<span class="hc-tag">{t('home.specialty-6')}</span>
				</div>
			</Container>
		</section>

		<section class="hc-why" data-reveal>
			<Container narrow>
				<h2 class="hc-heading hc-why__heading">
					{t('home.why-laguntza-title')}
				</h2>
				<div class="hc-bento">
					<article class="hc-bento__card hc-bento__card--hero">
						<h3>{t('home.why-1-title')}</h3>
						<p>{t('home.why-1-text')}</p>
					</article>
					<article class="hc-bento__card">
						<h3>{t('home.why-2-title')}</h3>
						<p>{t('home.why-2-text')}</p>
					</article>
					<article class="hc-bento__card">
						<h3>{t('home.why-3-title')}</h3>
						<p>{t('home.why-3-text')}</p>
					</article>
					<article class="hc-bento__card hc-bento__card--wide">
						<h3>{t('home.why-4-title')}</h3>
						<p>{t('home.why-4-text')}</p>
					</article>
				</div>
			</Container>
		</section>

		<section class="hc-cta" data-reveal>
			<Container narrow>
				<div class="hc-cta__card">
					<h2 class="hc-heading hc-heading--gradient">
						{t('service.cta-title')}
					</h2>
					<p class="hc-body">{t('service.cta-text')}</p>
					<a href={`/${lang}/contact`} class="hc-cta__btn">
						{t('Hitzordua hartu')}
					</a>
				</div>
			</Container>
		</section>
	</div>

	<footer id="hero-footer" slot="footer" class="landing-hero-footer">
		<LogoIsotipoWhite
			id="logo-see-more"
			class="logo-see-more-img"
			width={128}
			height={128}
		/>
		<p class="hero-footer-label">{t('Ikusi gehiago')}</p>
		<KeepScrolling class="keep-scrolling-icon" fill="currentColor" />
	</footer>
	<Footer id="site-footer" />
</Layout>

<style>
	body {
		--animate-bounce-pulse: bounce-pulse 2s ease-in-out infinite;
	}
	.background-image {
		width: 100vw;
		height: 100vh;
		object-fit: cover;
		object-position: center;
	}

	.hero-key-picture {
		height: 100vh;
		display: block;
		overflow: hidden;
		position: fixed;
		transform: scale(1.1);
	}

	.header-container {
		z-index: var(--z-index-modal);
		position: fixed;
		top: calc(var(--s5));
		right: var(--s2);
		display: flex;
		gap: var(--s2);
		align-items: center;
		& :global(.lang-toggle-btn) {
			background-color: var(--theme-bg);
		}
	}

	header[drawer-open] {
		z-index: var(--z-index-modal);
		position: fixed;
		& :global(.lang-toggle-btn) {
			opacity: 0;
		}
	}

	.header-burger-container {
		--circle-size: 48px;
		background-color: var(--theme-bg);
		opacity: 0.8;
		border-radius: 100%;
		width: var(--circle-size);
		height: var(--circle-size);
		border-radius: 50%;
		display: flex;
		align-items: center;
		justify-content: center;
		cursor: pointer;
		& :global(.burger) {
			display: flex;
		}
		&:hover {
			opacity: 1;
		}
	}

	#when {
		opacity: 0;
	}

	.coming-soon__address {
		display: flex;
		flex-direction: column;
		align-items: center;
		padding: var(--container-padding);
		gap: var(--s2);
		margin-top: var(--s2);
		svg {
			--size: var(--font-size-xl);
			width: var(--size);
			height: var(--size);
		}
	}

	.landing-h1 {
		font-size: clamp(1.5rem, 4vw, 2.2rem);
		font-weight: 700;
		text-align: center;
		letter-spacing: -0.02em;
		line-height: 1.2;
		margin: 0;
	}
	.landing-h1-sub {
		font-size: var(--font-size-sm);
		text-align: center;
		opacity: 0.7;
		font-weight: 400;
		margin: var(--s2) 0 0;
	}
	.coming-soon__label {
		font-size: var(--font-size-md);
		text-align: center;
	}
	#hero-key-logo {
		position: absolute;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		width: 80vw;
		padding: 10vw;
	}

	#logo-mask {
		position: fixed;
		top: 0;
		height: 100vh;
		width: 100%;
		background: white;
		mask-image: url('/logo-isotipo.svg');
		mask-position: center 55%;
		mask-repeat: no-repeat;
		mask-size: clamp(6000vh, 7500%, 0vh);
	}

	#when {
		position: fixed;
		bottom: 5%;
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		h3 {
			text-decoration: underline;
		}
	}

	.hero-footer-label {
		text-transform: uppercase;
		letter-spacing: 6px;
		white-space: nowrap;
		text-align: center;
		font-weight: 500;
		font-size: var(--font-size-md);
		text-shadow:
			0 0 2px rgba(255, 255, 255, 0.5),
			0 0 8px #000;
	}

	.landing-content {
		position: fixed;
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: space-between;
		height: 100vh;
		padding: var(--s4);
		width: 100%;
	}

	#when {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: var(--s4);
	}

	.cta-button {
		display: inline-block;
		padding: var(--s3) var(--s5);
		background-color: var(--theme-secondary, #e8944a);
		color: var(--theme-on-secondary, #000);
		text-decoration: none;
		border-radius: 0.5rem;
		font-weight: 600;
		font-size: var(--font-size-base);
		min-height: 48px;
		min-width: 48px;
		display: flex;
		align-items: center;
		justify-content: center;
		transition: all 0.3s ease-in-out;
		box-shadow: 0 4px 12px rgba(232, 148, 74, 0.3);
		white-space: nowrap;
		z-index: var(--z-index-tooltip);
	}

	.cta-button:hover {
		background-color: var(--theme-secondary-variant, #d67a2e);
		box-shadow: 0 6px 16px rgba(232, 148, 74, 0.5);
		transform: translateY(-2px);
	}

	.cta-button:active {
		transform: translateY(0);
	}

	.home-intro-text {
		font-size: var(--font-size-lg);
		font-weight: 500;
		max-width: 600px;
		text-align: center;
		margin: var(--s3) 0;
		opacity: 0.95;
		line-height: 1.6;
	}

	/* ====== HOMEPAGE CONTENT — Editorial Redesign ====== */

	.homepage-content {
		position: relative;
		z-index: 1400;
		background: linear-gradient(
			180deg,
			#020202 0%,
			#060a0d 20%,
			#0a0e10 50%,
			#080b0d 80%,
			#050809 100%
		);
		overflow: hidden;
	}

	/* Grain texture for organic warmth */
	.homepage-content::before {
		content: '';
		position: absolute;
		inset: 0;
		pointer-events: none;
		z-index: 0;
		opacity: 0.03;
		background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
		background-repeat: repeat;
		background-size: 200px;
	}

	.homepage-content > section {
		position: relative;
		z-index: 1;
	}

	/* Scroll reveal animations */
	[data-reveal] {
		opacity: 0;
		transform: translateY(32px);
		transition:
			opacity 0.9s cubic-bezier(0.16, 1, 0.3, 1),
			transform 0.9s cubic-bezier(0.16, 1, 0.3, 1);
	}
	[data-reveal].revealed {
		opacity: 1;
		transform: translateY(0);
	}

	/* ---- Shared typography ---- */
	.hc-heading {
		font-size: var(--font-size-xl);
		font-weight: 700;
		letter-spacing: -0.025em;
		line-height: 1.15;
		color: #fff;
		margin: 0 0 var(--s4);
	}
	.hc-heading--gradient {
		background: linear-gradient(
			135deg,
			var(--theme-primary) 0%,
			var(--theme-primary-300) 100%
		);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-clip: text;
	}
	.hc-body {
		font-size: var(--font-size-md);
		line-height: 1.85;
		color: rgba(255, 255, 255, 0.72);
		margin: 0;
	}
	.hc-label {
		display: inline-block;
		font-size: 0.78rem;
		font-weight: 600;
		letter-spacing: 0.14em;
		text-transform: uppercase;
		color: var(--theme-secondary);
		margin-bottom: var(--s3);
	}
	.hc-link {
		display: inline-flex;
		align-items: center;
		gap: 0.5em;
		color: var(--theme-secondary);
		font-weight: 600;
		font-size: var(--font-size-base);
		text-decoration: none;
		margin-top: var(--s4);
		transition: gap 0.3s cubic-bezier(0.16, 1, 0.3, 1);
	}
	.hc-link:hover {
		gap: 0.9em;
	}
	.hc-link__arrow {
		display: inline-block;
		transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
	}
	.hc-link:hover .hc-link__arrow {
		transform: translateX(4px);
	}

	/* ---- Section 1: Intro — Pull-quote style ---- */
	.hc-intro {
		padding: var(--s11) 0 var(--s9);
	}
	.hc-intro__inner {
		display: flex;
		gap: var(--s5);
		align-items: flex-start;
		max-width: 780px;
	}
	.hc-intro__accent {
		flex-shrink: 0;
		width: 4px;
		align-self: stretch;
		border-radius: 4px;
		background: linear-gradient(
			180deg,
			var(--theme-secondary) 0%,
			var(--theme-primary) 100%
		);
		opacity: 0.6;
	}
	.hc-intro__text {
		font-size: clamp(1.3rem, 2.5vw, 1.75rem);
		font-weight: 400;
		line-height: 1.75;
		color: rgba(255, 255, 255, 0.82);
		margin: 0;
		font-style: italic;
	}

	/* ---- Section 2: About Jokin — Magazine spread ---- */
	.hc-about {
		padding: var(--s8) 0 var(--s10);
		position: relative;
	}
	.hc-about::after {
		content: '';
		position: absolute;
		top: 15%;
		left: -8%;
		width: 420px;
		height: 420px;
		background: radial-gradient(
			circle,
			rgba(69, 130, 149, 0.07) 0%,
			transparent 70%
		);
		pointer-events: none;
		z-index: 0;
	}
	.hc-about__layout {
		display: grid;
		grid-template-columns: 1fr;
		gap: var(--s7);
		align-items: center;
		position: relative;
		z-index: 1;
	}
	@media (min-width: 768px) {
		.hc-about__layout {
			grid-template-columns: 340px 1fr;
			gap: var(--s10);
		}
	}
	@media (min-width: 1024px) {
		.hc-about__layout {
			grid-template-columns: 400px 1fr;
		}
	}
	.hc-about__photo-col {
		display: flex;
		justify-content: center;
	}
	.hc-about__photo-frame {
		position: relative;
		border-radius: 1.8rem;
		overflow: hidden;
		aspect-ratio: 3 / 4;
		max-width: 400px;
		width: 100%;
	}
	.hc-about__photo-frame::before {
		content: '';
		position: absolute;
		inset: -10px;
		border-radius: 2.2rem;
		background: linear-gradient(
			145deg,
			var(--theme-secondary) 0%,
			var(--theme-primary) 60%,
			transparent 100%
		);
		opacity: 0.2;
		filter: blur(28px);
		z-index: -1;
	}
	.hc-about__photo-frame :global(img) {
		width: 100%;
		height: 100%;
		object-fit: cover;
		display: block;
	}
	.hc-about__text-col {
		display: flex;
		flex-direction: column;
	}

	/* ---- Section 3: Services — Split composition ---- */
	.hc-services {
		padding: var(--s8) 0;
	}
	.hc-services__rule {
		height: 1px;
		background: linear-gradient(
			90deg,
			var(--theme-primary) 0%,
			rgba(69, 130, 149, 0.12) 100%
		);
		margin-bottom: var(--s8);
	}
	.hc-services__split {
		display: grid;
		grid-template-columns: 1fr;
		gap: var(--s5);
	}
	@media (min-width: 768px) {
		.hc-services__split {
			grid-template-columns: 1fr 1.4fr;
			gap: var(--s10);
			align-items: start;
		}
	}

	/* ---- Section 4: Specialties — Flowing tags ---- */
	.hc-specialties {
		padding: var(--s8) 0;
	}
	.hc-tags {
		display: flex;
		flex-wrap: wrap;
		gap: var(--s3);
		margin-top: var(--s5);
	}
	.hc-tag {
		padding: var(--s3) var(--s5);
		border-radius: 100px;
		font-size: var(--font-size-base);
		font-weight: 500;
		letter-spacing: 0.01em;
		border: 1px solid rgba(69, 130, 149, 0.22);
		color: var(--theme-primary-200);
		background: rgba(69, 130, 149, 0.03);
		transition: all 0.35s cubic-bezier(0.16, 1, 0.3, 1);
		cursor: default;
	}
	.hc-tag:hover {
		border-color: var(--theme-primary);
		background: rgba(69, 130, 149, 0.1);
		transform: translateY(-3px);
		box-shadow: 0 8px 24px -8px rgba(69, 130, 149, 0.2);
	}
	.hc-tag--warm {
		border-color: rgba(232, 148, 74, 0.22);
		color: var(--theme-secondary-200);
		background: rgba(232, 148, 74, 0.03);
	}
	.hc-tag--warm:hover {
		border-color: var(--theme-secondary);
		background: rgba(232, 148, 74, 0.1);
		box-shadow: 0 8px 24px -8px rgba(232, 148, 74, 0.2);
	}

	/* ---- Section 5: Why Choose — Bento grid ---- */
	.hc-why {
		padding: var(--s9) 0;
	}
	.hc-why__heading {
		text-align: center;
		margin-bottom: var(--s7);
	}
	.hc-bento {
		display: grid;
		grid-template-columns: 1fr;
		gap: var(--s4);
	}
	@media (min-width: 768px) {
		.hc-bento {
			grid-template-columns: repeat(3, 1fr);
			grid-auto-rows: auto;
		}
		.hc-bento__card--hero {
			grid-column: 1 / 3;
		}
		.hc-bento__card--wide {
			grid-column: 2 / 4;
		}
	}
	.hc-bento__card {
		padding: var(--s6);
		border-radius: 1.5rem;
		background: rgba(255, 255, 255, 0.02);
		border: 1px solid rgba(255, 255, 255, 0.06);
		transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
	}
	.hc-bento__card:hover {
		border-color: rgba(69, 130, 149, 0.25);
		background: rgba(69, 130, 149, 0.04);
		transform: translateY(-4px);
		box-shadow: 0 20px 50px -15px rgba(0, 0, 0, 0.4);
	}
	.hc-bento__card--hero {
		background: linear-gradient(
			135deg,
			rgba(232, 148, 74, 0.06) 0%,
			rgba(69, 130, 149, 0.04) 100%
		);
		border-color: rgba(232, 148, 74, 0.1);
	}
	.hc-bento__card--hero:hover {
		border-color: rgba(232, 148, 74, 0.25);
	}
	.hc-bento__card h3 {
		font-size: var(--font-size-lg);
		font-weight: 600;
		letter-spacing: -0.01em;
		margin: 0 0 var(--s3);
		color: var(--theme-primary-200);
	}
	.hc-bento__card--hero h3 {
		color: var(--theme-secondary-300);
	}
	.hc-bento__card p {
		font-size: var(--font-size-sm);
		line-height: 1.7;
		color: rgba(255, 255, 255, 0.58);
		margin: 0;
	}

	/* ---- Section 6: CTA — Warm gradient card ---- */
	.hc-cta {
		padding: var(--s6) 0 var(--s8);
	}
	.hc-cta__card {
		text-align: center;
		padding: var(--s9) var(--s6);
		border-radius: 2rem;
		background: linear-gradient(
			135deg,
			rgba(69, 130, 149, 0.08) 0%,
			rgba(232, 148, 74, 0.06) 50%,
			rgba(69, 130, 149, 0.04) 100%
		);
		border: 1px solid rgba(69, 130, 149, 0.12);
		position: relative;
		overflow: hidden;
	}
	.hc-cta__card::before {
		content: '';
		position: absolute;
		top: -40%;
		right: -10%;
		width: 300px;
		height: 300px;
		background: radial-gradient(
			circle,
			rgba(232, 148, 74, 0.06) 0%,
			transparent 70%
		);
		pointer-events: none;
	}
	.hc-cta__btn {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		padding: var(--s3) var(--s8);
		background: linear-gradient(
			135deg,
			var(--theme-secondary) 0%,
			#d47a30 100%
		);
		color: #000;
		text-decoration: none;
		border-radius: 100px;
		font-weight: 700;
		font-size: var(--font-size-base);
		min-height: 56px;
		margin-top: var(--s5);
		transition: all 0.35s cubic-bezier(0.16, 1, 0.3, 1);
		box-shadow: 0 4px 24px rgba(232, 148, 74, 0.25);
	}
	.hc-cta__btn:hover {
		transform: translateY(-3px) scale(1.02);
		box-shadow: 0 8px 36px rgba(232, 148, 74, 0.4);
	}
	.hc-cta__btn:active {
		transform: translateY(0) scale(0.98);
	}

	.landing-page {
		height: 550vh;
		background-color: var(--theme-primary);
		color: var(--theme-on-primary);
	}

	.logo-see-more-img {
		filter: drop-shadow(0 0 2px rgba(255, 255, 255, 0.5))
			drop-shadow(0 0 8px #000);
	}

	.landing-hero-footer {
		position: fixed;
		margin: auto;
		bottom: var(--s2);
		color: white;
		z-index: 1202;
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		gap: var(--s2);
		left: 50%;
		transform: translateX(-50%);
		cursor: pointer;
	}

	@keyframes bounce-pulse {
		0% {
			transform: translateY(0);
			scale: 0.8;
			opacity: 0.8;
		}

		50% {
			transform: translateY(-5px);
			opacity: 1;
			scale: 1;
		}

		100% {
			transform: translateY(0);
			scale: 0.8;
			opacity: 0.8;
		}
	}

	.keep-scrolling-icon {
		animation: var(--animate-bounce-pulse);
		color: #fff;
		filter: drop-shadow(var(--shadow-2xl));
	}

	.service-section-card {
		background: var(--theme-surface-1,);
		position: fixed;
		top: 50%;
		left: 50%;
		width: 90vw;
		max-width: 500px;
		max-height: 75vh;
		aspect-ratio: 1 / 1;
		transform: translateY(-50%) translateX(-50%);
		position: fixed;
		color: var(--theme-on-surface-1, #000);
		border-radius: var(--theme-shape-radius);
		box-shadow: var(--shadow-lg);
		padding-top: var(--s6);
		transition: box-shadow 0.2s;
		background-size: cover;
		background-position: center;
		background-repeat: no-repeat;
		position: fixed;
		overflow: hidden;
		img {
			height: 100%;
			width: 100%;
			object-fit: cover;
			border-radius: var(--theme-shape-radius);
			position: absolute;
			inset: 0;
		}
	}
	.service-section-card__bg-overlay {
		position: absolute;
		inset: 0;
		background: linear-gradient(
			120deg,
			rgba(0, 0, 0, 0.45) 0%,
			rgba(0, 0, 0, 0.25) 60%,
			rgba(0, 0, 0, 0.65) 100%
		);
		z-index: 1;
		pointer-events: none;
	}
	.service-section-card__desc {
		position: relative;
		z-index: 2;
		flex-direction: column;
		justify-content: center;
		align-items: flex-start;
		height: 100%;
		padding-left: var(--s2);
		padding-right: var(--s2);
	}
	.service-section-card__desc h2 {
		margin-bottom: var(--s2);
		font-size: var(--font-size-md);
		font-weight: 700;
		letter-spacing: 1px;
		color: #fff;
		text-shadow:
			0 2px 12px rgba(0, 0, 0, 0.18),
			0 1px 0 #fff8;
	}

	.service-section {
		height: 100vh;
		width: 100vw;
		z-index: 1201;
		top: 0;
		position: fixed;
		visibility: hidden;
	}

	.service-section__outer {
		width: 100%;
		height: 100vh;
		overflow-y: hidden;
	}

	#site-footer {
		position: relative;
		z-index: 1400;
	}

	.global-loader {
		position: fixed;
		inset: 0;
		z-index: 99999;
		background: var(--theme-bg, #fff);
		color: var(--theme-primary, #222);
		display: flex;
		align-items: center;
		justify-content: center;
		transition: opacity 0.4s;
		opacity: 1;
		pointer-events: all;
	}
	.global-loader.hide {
		opacity: 0;
		pointer-events: none;
		transition: opacity 0.4s;
	}
</style>

<script>
	import { gsap } from 'gsap';
	import { ScrollTrigger } from 'gsap/ScrollTrigger';

	function hideGlobalLoader() {
		const loader = document.getElementById('global-loader');
		if (loader) loader.classList.add('hide');
	}

	document.addEventListener('astro:page-load', () => {
		const bgImg = document.getElementById('hero-key-background');

		if (bgImg && (bgImg as HTMLImageElement).complete !== undefined) {
			const img = bgImg as HTMLImageElement;
			if (!img.complete) {
				img.addEventListener('load', hideGlobalLoader, { once: true });
				img.addEventListener('error', hideGlobalLoader, { once: true });
			} else {
				hideGlobalLoader();
			}
		} else {
			hideGlobalLoader();
		}

		const comingSoonContainer = document.getElementById('landing-page');
		const heroFooter = document.getElementById('hero-footer');

		if (!comingSoonContainer) {
			return;
		}
		window.scrollTo({ top: 0, left: 0, behavior: 'auto' });

		gsap.registerPlugin(ScrollTrigger);

		const tl = gsap.timeline({
			ease: 'power2.out',
			scrollTrigger: {
				trigger: '#landing-page',
				start: 'top top',
				end: 'bottom bottom',
				scrub: 1
			}
		});

		const sections = gsap.utils.toArray('.service-section');
		const outerWrappers = gsap.utils.toArray('.service-section__outer');

		gsap.set('.service-section:nth-of-type(1) .service-section__outer', {
			xPercent: 0
		});

		tl.to('#hero-key', { scale: 1 })
			.to('#hero-key-logo', { opacity: 0 }, '<')
			.to('#logo-see-more', { opacity: 0 }, '<')
			.to('#hero-footer', { maxHeight: '15vh' }, '<')
			.to(
				'#logo-mask',
				{
					maskSize: 'clamp(20vh, 25%, 30vh)'
				},
				0.15
			)
			.to(
				'#hero-key',
				{
					opacity: 0,
					duration: 0.2
				},
				0.4
			)

			.to('#when', { opacity: 1, y: -150 }, '>')
			.to(
				'#logo-mask',
				{
					maskPosition: '50% 15%'
				},
				'<'
			)
			.to('#drawer-backdrop', { opacity: 1 }, '>');

		outerWrappers.forEach((card, i) => {
			const isEven = i % 2 === 0;
			tl.fromTo(
				card,
				{
					xPercent: isEven ? -100 : 100,
					scale: 0.6,
					rotate: isEven ? -30 : 30
				},
				{
					xPercent: 0,
					scale: 1,
					duration: 0.5,
					rotate: 0
				},
				i === 0 ? '<' : '>'
			).to(sections[i], { visibility: 'visible' }, '<');
		});

		tl.to('#hero-footer', { opacity: 0, duration: 0 }, '>');

		heroFooter?.addEventListener('click', () => {
			console.log('Scrolling down...');
			window.scrollBy({
				top: (window.innerHeight / 3) * 2,
				left: 0,
				behavior: 'smooth'
			});
		});
	});
</script>

<script>
	document.addEventListener('astro:page-load', () => {
		const revealEls = document.querySelectorAll('[data-reveal]');
		if (!revealEls.length) return;
		const observer = new IntersectionObserver(
			entries => {
				entries.forEach(entry => {
					if (entry.isIntersecting) {
						entry.target.classList.add('revealed');
						observer.unobserve(entry.target);
					}
				});
			},
			{ threshold: 0.1, rootMargin: '0px 0px -40px 0px' }
		);
		revealEls.forEach(el => observer.observe(el));
	});
</script>
